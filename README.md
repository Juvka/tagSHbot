# TagBot — Бот для подсчёта хештегов в Telegram-канале

Telegram-бот считает все хештеги (#) в сообщениях канала и показывает статистику на веб-сайте в реальном времени.

## Что нужно от вас

### 1. Создать бота и получить токен

1. Откройте Telegram и найдите [@BotFather](https://t.me/BotFather)
2. Отправьте команду `/newbot`
3. Введите имя бота (например: `TagBot`)
4. Введите username (например: `my_channel_tagbot`)
5. Скопируйте полученный **токен** (вида `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`)

### 2. Добавить бота в канал как администратора

1. Откройте настройки вашего канала
2. Выберите **Администраторы** → **Добавить администратора**
3. Найдите вашего бота по username и добавьте его
4. Включите права **Публикация сообщений** (или хотя бы право видеть сообщения — зависит от версии Telegram)

> Важно: без прав администратора бот не получит сообщения канала.

### 3. Настроить проект

1. Скопируйте `.env.example` в `.env`:
   ```bash
   copy .env.example .env
   ```
2. Откройте `.env` и вставьте значения:
   ```
   BOT_TOKEN=ваш_токен_от_BotFather
   PORT=3000
   CHANNEL_USERNAME=ваш_канал
   ```
   `CHANNEL_USERNAME` — username канала без @ (например, `mychannel`). Нужен для ссылок «Открыть в Telegram» на сайте.

### 4. Установить зависимости и запустить

```bash
npm install
npm start
```

После запуска:
- Бот начинает считать хештеги в сообщениях канала
- Веб-статистика доступна по адресу: **http://localhost:3000**

## Автономная работа 24/7

### Вариант 1: PM2 (на вашем ПК)

Бот будет работать в фоне, перезапускаться при сбоях и после перезагрузки ПК.

1. Установите PM2 глобально:
   ```bash
   npm install -g pm2
   ```

2. Запустите бота:
   ```bash
   npm run pm2:start
   ```

3. Добавьте автозапуск при включении ПК:
   ```bash
   pm2 startup
   pm2 save
   ```

**Команды PM2:**
- `npm run pm2:logs` — просмотр логов
- `npm run pm2:restart` — перезапуск
- `npm run pm2:stop` — остановка

> Компьютер должен быть включён. Для работы без ПК — используйте облако (вариант 2).

### Вариант 2: Облако (Railway, Render)

Разместите бота в облаке — он будет работать без вашего компьютера.

**Railway:**
1. Зарегистрируйтесь на [railway.app](https://railway.app)
2. New Project → Deploy from GitHub (или Upload)
3. Добавьте переменные: `BOT_TOKEN`, `PORT`, `CHANNEL_USERNAME`
4. Railway сам определит запуск по Procfile

**Render:**
1. [render.com](https://render.com) → New → Web Service
2. Подключите репозиторий или загрузите проект
3. Build: `npm install`, Start: `npm start`
4. В разделе Environment задайте `BOT_TOKEN`, `CHANNEL_USERNAME`

> Укажите `PORT` как в документации платформы (часто задаётся автоматически).

## Функции

- Подсчёт хештегов в тексте и подписях к медиа
- Учёт кириллицы, латиницы и цифр в тегах
- База данных SQLite — данные сохраняются между перезапусками
- Веб-дашборд с обновлением в реальном времени (Socket.io)
- Пагинация, поиск, сортировка, ссылки на Telegram, статистика «в день» и «последнее использование»
